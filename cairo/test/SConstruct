import os, sys, string
sys.path.append('../..')
import configure

plots = '7ab'

try:
	Import('env')
	root = env.get('RSFROOT')
	libdir = os.path.join(root,'lib')
	bindir = os.path.join(root,'bin')
	incdir = os.path.join(root,'include')
except:
	root = None
	env = Environment()
	opts=Options('../../config.py')
	configure.options(opts)
	opts.Update(env)
	env['CCFLAGS'] = string.replace(env.get('CCFLAGS',''),'-O2','-g')
	env.Append(CPPPATH=['../../include'],
		   LIBPATH=['../../filt/lib','../lib'],
		   LIBS=['rsfcairo','rsf'])
	SConscript('../lib/SConstruct')

#vplot = Builder(action = './$SOURCE > $TARGET',suffix='.vpl')
#env.Append(BUILDERS = {'Vplot' : vplot})

ccflags = ' ' + env.get('CCFLAGS','')
del env['CCFLAGS']
libs = 'gtk+-2.0 cairo >= 0.1.1 gtkcairo'
env.ParseConfig('pkg-config --cflags --libs "%s" ' % libs)
env['CCFLAGS'] = ccflags

env['PROGPREFIX'] = 'cr'

mains = []

for plot in Split(plots):
	prog = env.Program(plot+'.c')
	mains.append(plot+'.c')
	if root:
		env.Install(bindir,prog)

######################################################################
# SELF-DOCUMENTATION
######################################################################
if root:
	main = 'crplot.py'
    
	docs = map(lambda prog: env.Doc(prog,rsfprefix='cr'),mains)
	docmerge = configure.docmerge
	doc = env.Command(main,docs,docmerge)
	env.Install(libdir,doc)
#	Clean(os.path.join(libdir,main),os.path.join(libdir,main+'c'))
#####################################################################


# 	$Id: SConstruct 719 2004-07-25 23:09:36Z fomels $	
