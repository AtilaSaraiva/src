<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RvlUmin: RVLUmin::LSQRAlg&lt; Scalar &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RvlUmin&#160;<span id="projectnumber">1.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceRVLUmin.html">RVLUmin</a>      </li>
      <li class="navelem"><a class="el" href="classRVLUmin_1_1LSQRAlg.html">LSQRAlg</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<h1>RVLUmin::LSQRAlg&lt; Scalar &gt; Class Template Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="RVLUmin::LSQRAlg" --><!-- doxytag: inherits="RVLAlg::Algorithm,RVLAlg::Terminator" -->
<p>This is Algorithm LSQR as stated in Paige and Saunders, ACM TOMS vol.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="lsqr_8hh_source.html">lsqr.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for RVLUmin::LSQRAlg&lt; Scalar &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classRVLUmin_1_1LSQRAlg.png" usemap="#RVLUmin::LSQRAlg&lt; Scalar &gt;_map" alt=""/>
  <map id="RVLUmin::LSQRAlg&lt; Scalar &gt;_map" name="RVLUmin::LSQRAlg&lt; Scalar &gt;_map">
<area doxygen="RVLALG.tag:../../../alg/doc/html/" href="../../../alg/doc/html/classRVLAlg_1_1Algorithm.html" alt="RVLAlg::Algorithm" shape="rect" coords="0,0,182,24"/>
<area doxygen="RVLALG.tag:../../../alg/doc/html/" href="../../../alg/doc/html/classRVLAlg_1_1Terminator.html" alt="RVLAlg::Terminator" shape="rect" coords="192,0,374,24"/>
</map>
 </div></div>

<p><a href="classRVLUmin_1_1LSQRAlg-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRVLUmin_1_1LSQRAlg.html#a9336c996d881d168742d34212b12e6e6">LSQRAlg</a> (<a class="elRef" doxygen="RVL.tag:../../../rvl/doc/html//" href="../../../rvl/doc/html/classRVL_1_1Vector.html">RVL::Vector</a>&lt; Scalar &gt; &amp;_x, <a class="elRef" doxygen="RVL.tag:../../../rvl/doc/html//" href="../../../rvl/doc/html/classRVL_1_1LinearOp.html">LinearOp</a>&lt; Scalar &gt; const &amp;_inA, <a class="elRef" doxygen="RVL.tag:../../../rvl/doc/html//" href="../../../rvl/doc/html/classRVL_1_1Vector.html">Vector</a>&lt; Scalar &gt; const &amp;_rhs, atype &amp;_rnorm, atype &amp;_nrnorm, atype _rtol=100.0 *numeric_limits&lt; atype &gt;::epsilon(), atype _nrtol=100.0 *numeric_limits&lt; atype &gt;::epsilon(), int _maxcount=10, atype _maxstep=numeric_limits&lt; atype &gt;::max(), ostream &amp;_str=cout)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a9336c996d881d168742d34212b12e6e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRVLUmin_1_1LSQRAlg.html#ac9868cc97f42e97f60522b51764b8c32">~LSQRAlg</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRVLUmin_1_1LSQRAlg.html#a8599823afb42dd5f53e79e8d57071c20">query</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRVLUmin_1_1LSQRAlg.html#a60b7be905f391720fdf00f131ddee35b">run</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRVLUmin_1_1LSQRAlg.html#a79de1b84c39e32ee098f8deade3f1916">getCount</a> () const </td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Scalar&gt;<br/>
 class RVLUmin::LSQRAlg&lt; Scalar &gt;</h3>

<p>This is Algorithm LSQR as stated in Paige and Saunders, ACM TOMS vol. </p>
<p>8 pp. 43-72 1982 (see p. 8). We use variable names aping Paige and Saunder's notation insofar as possible.</p>
<p>Structure and function: Combines <a class="el" href="classRVLUmin_1_1LSQRStep.html" title="Single step of LSQR iteration for solution of the normal equations, per Paige &amp; Saunders...">LSQRStep</a> with a Terminator which displays iteration count, residual norm, and normal residual norm on output stream (constructor argument _str), and terminates if iteration count exceeds max or residual norm or normal residual norm fall below threshhold (default = 10*sqrt(macheps)). Also terminates if the length of the solution vector exceeds a specified bound (maxstep argument to constructor). In this latter case, the computed step is projected onto the ball of radius maxstep centered at the initial estimate. This maximum step limit and projection turns the algorithm into an approximate trust region subproblem solver, similar to Steihaug-Toint. The default choice of maxstep is the max Scalar, which effectively turns off the trust region feature.</p>
<p>Usage: construct <a class="el" href="classRVLUmin_1_1LSQRAlg.html" title="This is Algorithm LSQR as stated in Paige and Saunders, ACM TOMS vol.">LSQRAlg</a> object by supplying appropriate arguments to constructor. On return from constructor, solution vector initialized to zero, residual norm to norm of RHS, and normal residual norm to norm of image of RHS under adjoint of operator. Then call <a class="el" href="classRVLUmin_1_1LSQRAlg.html#a60b7be905f391720fdf00f131ddee35b">run()</a> method. Progress of iteration written on output unit. On return from <a class="el" href="classRVLUmin_1_1LSQRAlg.html#a60b7be905f391720fdf00f131ddee35b">run()</a>, solution vector stores final estimate of solution, and residual norm and normal residual norm scalars have corresponding values.</p>
<p>Typical Use: see <a href="../../testsrc/testlsqr.cc">functional test source</a>.</p>
<p>IMPORTANT NOTE: This class is also an <a class="elRef" doxygen="RVLALG.tag:../../../alg/doc/html/" href="../../../alg/doc/html/classRVLAlg_1_1Terminator.html">RVLAlg::Terminator</a> subclass. Its <a class="el" href="classRVLUmin_1_1LSQRAlg.html#a8599823afb42dd5f53e79e8d57071c20">query()</a> method returns true if the trust region constraint was binding (raw LS solution larger than trust radius), else false.</p>
<p>IMPORTANT NOTE: The solution vector and residual and normal residual scalars are external objects, for which this algorithm stores mutable references. These objects are updated by constructing a <a class="el" href="classRVLUmin_1_1LSQRAlg.html" title="This is Algorithm LSQR as stated in Paige and Saunders, ACM TOMS vol.">LSQRAlg</a> object, and by calling its <a class="el" href="classRVLUmin_1_1LSQRAlg.html#a60b7be905f391720fdf00f131ddee35b">run()</a> method.</p>
<p>IMPORTANT NOTE: this version of the algorithm initializes the solution vector to zero. To accommodate nontrivial initial guess, <em>modify the right-hand-side vector</em> (argument _rhs) externally.</p>
<p>IMPORTANT NOTE: in order that this algorithm function properly for complex scalar types, a careful distinction is maintained between the main template parameter (Scalar) type and its absolute value type. All of the scalars appearing in the algorithm are actually of the latter type.</p>
<p>See constructor documentation for description of parameters. </p>

<p>Definition at line <a class="el" href="lsqr_8hh_source.html#l00272">272</a> of file <a class="el" href="lsqr_8hh_source.html">lsqr.hh</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a9336c996d881d168742d34212b12e6e6"></a><!-- doxytag: member="RVLUmin::LSQRAlg::LSQRAlg" ref="a9336c996d881d168742d34212b12e6e6" args="(RVL::Vector&lt; Scalar &gt; &amp;_x, LinearOp&lt; Scalar &gt; const &amp;_inA, Vector&lt; Scalar &gt; const &amp;_rhs, atype &amp;_rnorm, atype &amp;_nrnorm, atype _rtol=100.0 *numeric_limits&lt; atype &gt;::epsilon(), atype _nrtol=100.0 *numeric_limits&lt; atype &gt;::epsilon(), int _maxcount=10, atype _maxstep=numeric_limits&lt; atype &gt;::max(), ostream &amp;_str=cout)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRVLUmin_1_1LSQRAlg.html">RVLUmin::LSQRAlg</a>&lt; Scalar &gt;::<a class="el" href="classRVLUmin_1_1LSQRAlg.html">LSQRAlg</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" doxygen="RVL.tag:../../../rvl/doc/html//" href="../../../rvl/doc/html/classRVL_1_1Vector.html">RVL::Vector</a>&lt; Scalar &gt; &amp;&#160;</td>
          <td class="paramname"><em>_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" doxygen="RVL.tag:../../../rvl/doc/html//" href="../../../rvl/doc/html/classRVL_1_1LinearOp.html">LinearOp</a>&lt; Scalar &gt; const &amp;&#160;</td>
          <td class="paramname"><em>_inA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" doxygen="RVL.tag:../../../rvl/doc/html//" href="../../../rvl/doc/html/classRVL_1_1Vector.html">Vector</a>&lt; Scalar &gt; const &amp;&#160;</td>
          <td class="paramname"><em>_rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">atype &amp;&#160;</td>
          <td class="paramname"><em>_rnorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">atype &amp;&#160;</td>
          <td class="paramname"><em>_nrnorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">atype&#160;</td>
          <td class="paramname"><em>_rtol</em> = <code>100.0*numeric_limits&lt;atype&gt;::epsilon()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">atype&#160;</td>
          <td class="paramname"><em>_nrtol</em> = <code>100.0*numeric_limits&lt;atype&gt;::epsilon()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_maxcount</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">atype&#160;</td>
          <td class="paramname"><em>_maxstep</em> = <code>numeric_limits&lt;atype&gt;::max()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ostream &amp;&#160;</td>
          <td class="paramname"><em>_str</em> = <code>cout</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">_x</td><td>- mutable reference to solution vector (external), initialized to zero vector on construction, estimated solution on return from <a class="el" href="classRVLUmin_1_1LSQRAlg.html#a60b7be905f391720fdf00f131ddee35b">LSQRAlg::run()</a>.</td></tr>
    <tr><td class="paramname">_inA</td><td>- const reference to LinearOp (external) defining problem</td></tr>
    <tr><td class="paramname">_rhs</td><td>- const reference to RHS or target vector (external)</td></tr>
    <tr><td class="paramname">_rnorm</td><td>- mutable reference to residual norm scalar (external), initialized to norm of RHS on construction, norm of estimated residual at solution on return from <a class="el" href="classRVLUmin_1_1LSQRAlg.html#a60b7be905f391720fdf00f131ddee35b">LSQRAlg::run()</a></td></tr>
    <tr><td class="paramname">_nrnorm</td><td>- mutable reference to normal residual (least squares gradient) norm scalar (external), initialized to morm of image of RHS under adjoint of problem LinearOp on construction, norm of estimated normal residual at solution on return from <a class="el" href="classRVLUmin_1_1LSQRAlg.html#a60b7be905f391720fdf00f131ddee35b">LSQRAlg::run()</a></td></tr>
    <tr><td class="paramname">_rtol</td><td>- stopping threshold for residual norm, default value = 100.0*macheps</td></tr>
    <tr><td class="paramname">_nrtol</td><td>- stopping threshold for normal residual norm, default value = 100.0*macheps</td></tr>
    <tr><td class="paramname">_maxcount</td><td>- max number of iterations permitted, default value = 10</td></tr>
    <tr><td class="paramname">_maxstep</td><td>- max permitted step length (trust radius), default value = max absval scalar (which makes the trust region feature inactive)</td></tr>
    <tr><td class="paramname">_str</td><td>- output stream </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="lsqr_8hh_source.html#l00317">317</a> of file <a class="el" href="lsqr_8hh_source.html">lsqr.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ac9868cc97f42e97f60522b51764b8c32"></a><!-- doxytag: member="RVLUmin::LSQRAlg::~LSQRAlg" ref="ac9868cc97f42e97f60522b51764b8c32" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRVLUmin_1_1LSQRAlg.html">RVLUmin::LSQRAlg</a>&lt; Scalar &gt;::~<a class="el" href="classRVLUmin_1_1LSQRAlg.html">LSQRAlg</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lsqr_8hh_source.html#l00342">342</a> of file <a class="el" href="lsqr_8hh_source.html">lsqr.hh</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a8599823afb42dd5f53e79e8d57071c20"></a><!-- doxytag: member="RVLUmin::LSQRAlg::query" ref="a8599823afb42dd5f53e79e8d57071c20" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classRVLUmin_1_1LSQRAlg.html">RVLUmin::LSQRAlg</a>&lt; Scalar &gt;::query </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="elRef" doxygen="RVLALG.tag:../../../alg/doc/html/" href="../../../alg/doc/html/classRVLAlg_1_1Terminator.html#ab7a71a3442d4c8b6d16f3e56e8e7e985">RVLAlg::Terminator</a>.</p>

<p>Definition at line <a class="el" href="lsqr_8hh_source.html#l00344">344</a> of file <a class="el" href="lsqr_8hh_source.html">lsqr.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a60b7be905f391720fdf00f131ddee35b"></a><!-- doxytag: member="RVLUmin::LSQRAlg::run" ref="a60b7be905f391720fdf00f131ddee35b" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classRVLUmin_1_1LSQRAlg.html">RVLUmin::LSQRAlg</a>&lt; Scalar &gt;::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="elRef" doxygen="RVLALG.tag:../../../alg/doc/html/" href="../../../alg/doc/html/classRVLAlg_1_1Algorithm.html#a1f2607e339d136836946b756b7e21dc0">RVLAlg::Algorithm</a>.</p>

<p>Definition at line <a class="el" href="lsqr_8hh_source.html#l00346">346</a> of file <a class="el" href="lsqr_8hh_source.html">lsqr.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a79de1b84c39e32ee098f8deade3f1916"></a><!-- doxytag: member="RVLUmin::LSQRAlg::getCount" ref="a79de1b84c39e32ee098f8deade3f1916" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classRVLUmin_1_1LSQRAlg.html">RVLUmin::LSQRAlg</a>&lt; Scalar &gt;::getCount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lsqr_8hh_source.html#l00379">379</a> of file <a class="el" href="lsqr_8hh_source.html">lsqr.hh</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="lsqr_8hh_source.html">lsqr.hh</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Thu Jan 29 2015 14:34:20 for RvlUmin by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
