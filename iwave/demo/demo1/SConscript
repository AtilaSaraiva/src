import os
import shutil
Import('cmddict','parlist','env','thispath')

def cmdlink(target, source, env):
    for cmd in target:
        cmdpath = os.path.abspath(os.path.expandvars(str(cmddict[str(cmd)])))
        os.system('cd ' + cmdpath + '; scons main/' + str(cmd) + '; cd ' + thispath)
        os.system('ln -s ' + cmdpath + '/main/' + str(cmd) + ' .')
    
env.Command(cmddict.keys(),['SConstruct'],cmdlink)

def printpars(target, source, env):
    parfile = str(target[0])
    f = open(parfile,'w')
    f.write('--------------------------- IWAVE PARAMETER LIST -----------------------------\n')
    for l in parlist:
    	if 'title' in l:
	    f.write(l['title']+'\n\n')
        parkeys = l.keys()
    	for k in parkeys:
	    if k != 'title':
	        f.write(k + ' = ' + str(l[k])+'\n')
        f.write('\n')
    f.close()

env.Command(['demo.par'], ['SConstruct'], printpars)

