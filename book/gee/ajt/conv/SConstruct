###########################################################################
# STANDARD HEADER
###########################################################################
import sys, os

root = os.environ.get('RSFROOT')
sys.path.append(os.path.join(root,'lib'))

from rsfproj import *
###########################################################################
Book()

Flow('in',None,'spike n1=15 label1=" " ')
Flow('filt1',None,
     '''
     echo 1. -.5 > $TARGET;
     echo esize=0 n1=2 in=$TARGET >> $TARGET;
     echo data_format=ascii_float  >> $TARGET
     ''',stdout=-1)
Flow('filt','filt1','dd data_format=native_float')

Flow('1','in filt','conv filt=${SOURCES[1]} trans=n | pad n1=16')
Flow('2','in filt','conv filt=${SOURCES[1]} trans=y | pad n1=16')
Flow('pin','in','pad n1=16')
Flow('pf','filt','pad n1=16')

Result('conv',['1','2','pf','pin'],
       '''cat axis=2 ${SOURCES[1:4]} |
       dots dots=2 connect=0 gaineach=0 overlap=1.25
       labels=icai1:tcai1:filter:input labelsz=14''')

###########################################################################
End()
