\author{Gustav Kirchhoff} 
%%%%%%%%%%%%%%%%%%%%%%%%%
\title{Homework 3}

\begin{abstract}
  This homework has two parts. In the theoretical part, you will
  perform several analytical derivations related to 
  geometrical inetgration and reflections from elliptical reflections. In the
  computational part, you will experiment with imaging a synthetic
  dataset and a field dataset from the Gulf of Mexico.
\end{abstract}

Completing the computational part of this homework assignment requires
\begin{itemize}
\item \texttt{Madagascar} software environment available from \\
  \url{http://www.ahay.org}
\item \LaTeX\ environment with \texttt{SEGTeX} available from \\ 
  \url{http://www.ahay.org/wiki/SEGTeX}
\end{itemize}

You are welcome to do the assignment on your personal computer by
installing the required environments. In this case, you can obtain all
homework assignments from the \texttt{Madagascar} repository by running
\begin{verbatim}
svn co https://rsf.svn.sourceforge.net/svnroot/rsf/trunk/book/geo384w/hw3 
\end{verbatim}

\section{Theoretical part}

\begin{enumerate}
\item Consider a 2-D common-midpoint gather $G(t,x)$, which
  contains a geometrical event $A_0\,f\left(t-T(x)\right)$ with a
  constant amplitude $A_0$ along a parabolic shape
\begin{equation}
\label{eq:hyper}
T(x) = t_0+a\,x^2\;.
\end{equation}
The gather gets transformed by the slant-stack (Radon transform) operator
\begin{equation}
\label{eq:radon}
R(\tau,p) = \mathbf{D}_t^{1/2} \int G(\tau + p x, x) d x\;.
\end{equation}
where $ \mathbf{D}_t^{1/2}$ is a waveform-correcting half-order
derivative operator.

Using the theory of geometrical integration, show that $R(\tau,p)$
will contain a geometrical event $A_1(p)\,f\left(\tau-T_1(p)\right)$.
Determine $T_1(p)$ and $A_1(p)$.

\newpage

\item Consider source and receiver coordinates $s$ and $r$ on the
  surface of a 2-D constant-velocity medium with velocity
  $V$. 

  \begin{enumerate}
  \item Assuming that the reflection traveltime is $T$, show that the
    reflection point $\{x,z\}$ must belong to an ellipse (\emph{migration
      impulse response})
    \begin{equation}
      \label{eq:ellipse}
      z(x) = \sqrt{R^2 - \alpha\,(x-m)^2}\;,
    \end{equation}
    where $R=V\,T_n/2$, $T_n=\sqrt{T^2-\frac{4\,h^2}{V^2}}$, $h=(r-s)/2$, and $m=(r+s)/2$.
  \item Find $\alpha$.
  \item Consider that the ellipse in equation~\ref{eq:ellipse} as a
    reflection surface and apply Fermat's principle to find the reflection
    traveltime $T_0(x_0)$ for observations with sources and receivers coincident at $x_0$.
  \end{enumerate}

\end{enumerate}

\section{Computational part}

\begin{enumerate}
\item In the first part, you will experiment with creating and 
  imaging a synthetic seismic reflection dataset.

  \inputdir{synth}

 \plot{data}{width=0.9\textwidth}{2-D synthetic data.}
  \sideplot{model}{width=\textwidth}{(a) Synthetic model: curved
    reflectors in a $V(z)$ velocity.}
  \plot{vscan}{width=0.9\textwidth}{Velocity semblance scan.}
  \plot{vnmo}{width=0.9\textwidth}{RMS velocity (a) and picked NMO velocity (b).}
  \multiplot{2}{dstack,zoff}{width=0.45\textwidth}{(a) DMO stack. (b)
    Zero-offset section.}
  \plot{tmig}{width=0.9\textwidth}{Kirchhoff poststack time
    migration.}
  \sideplot{dmig2}{width=\textwidth}{Time migration converted to depth, with reflectors overlaid.}

Figure~\ref{fig:data} shows a synthetic reflection dataset computed
from a reflector model shown in Figure~\ref{fig:model} and assuming a
velocity model with a constant vertical gradient $V(z) = 1.5 +
0.25\,z$. A small amount of random noise is added to the synthetic data.

Figure~\ref{fig:vscan} shows a conventional velocity semblance
scan. Figure~\ref{fig:vnmo} compares the RMS velocity with the NMO
velocity picked from the scan. Figure~\ref{fig:dstack,zoff} compares a
DMO stack and the zero-offset section from the data. Finally,
Figure~\ref{fig:tmig,dmig2} shows the result of Kirchhoff time
migration before and after conversion from time to depth.

\begin{enumerate}
\item Change directory 
\begin{verbatim}
cd hw3/synth
\end{verbatim}
\item Run
\begin{verbatim}
scons view
\end{verbatim}
to generate the figures and display them on your screen.
If you are on a computer with multiple CPUs, you
can also try
\begin{verbatim}
pscons view
\end{verbatim}
to run certain computations in parallel.
\item Explain the cause of the difference between the RMS velocity and the NMO velocity in Figure~\ref{fig:vnmo}.
\item Edit the \texttt{SConstruct} file to switch on the antialiasing parameter in Kirchhoff migration 
(by changing it from 0 to 1). Generate the migration figures again. What differences do you observe?
\item Edit the \texttt{kirchhoff.c} file to improve the result of migration. This task is open-ended. 
The change is up to you, as long as you can achieve an improvement. Possible options:
\begin{itemize}
\item Use a more accurate traveltime computation.
\item Introduce an amplitude weight.
\item Change from time to depth migration (you can assume a locally $V(z)$ medium and use results from previous homeworks.)
\item Change from poststack to prestack migration.
\end{itemize}
\item The processing flow in the \texttt{SConstruct} file involves some cheating: the exact 
depth velocity and the exact RMS velocity are used without being
estimated from the data. Modify the processing flow so that only
properties estimated from the data get used. This task is open-ended
as well, different data processing strategies are possible.
\end{enumerate}

\lstset{language=python,numbers=left,numberstyle=\tiny,showstringspaces=false}
\lstinputlisting[frame=single]{synth/SConstruct}

\lstset{language=c,numbers=left,numberstyle=\tiny,showstringspaces=false}
\lstinputlisting[frame=single]{synth/kirchhoff.c}

\newpage

\inputdir{gulf}
\plot{gulf}{width=0.8\textwidth}{2-D field dataset from the Gulf of Mexico.}

\item In the second part of the computational assignment, you will use the processing strategy developed for synthetic data, 
to process a 2-D field dataset from the Gulf of Mexico, shown in Figure~\ref{fig:gulf}.

\begin{enumerate}
\item Change directory 
\begin{verbatim}
cd hw3/gulf
\end{verbatim}
\item Run
\begin{verbatim}
scons view
\end{verbatim}
to generate the figures and display them on your screen.
\item Edit the \texttt{SConstruct} file to implement your processing strategy. 
Make sure to select appropriate processing parameters.
\end{enumerate}

\lstset{language=python,numbers=left,numberstyle=\tiny,showstringspaces=false}
\lstinputlisting[frame=single]{gulf/SConstruct}

\end{enumerate}

\section{Completing the assignment}

\begin{enumerate}
\item Change directory to \verb#hw3#.
\item Edit the file \texttt{paper.tex} in your favorite editor and change the
  first line to have your name instead of Kirchhoff's.
\item Run
\begin{verbatim}
sftour scons lock
\end{verbatim}
to update all figures.
\item Run
\begin{verbatim}
sftour scons -c
\end{verbatim}
to remove intermediate files.
\item Run
 \begin{verbatim} 
 scons pdf
\end{verbatim}
  to create the final document.
\item Submit your result (file \texttt{paper.pdf}) on paper or by
  e-mail. 
\end{enumerate}