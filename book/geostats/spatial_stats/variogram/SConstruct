#
# Fast variogram computation with FFTs  
#
# James W. Jennings Jr.
# Research Scientist
# 
# Bureau of Economic Geology
# John A. and Katherine G. Jackson School of Geosciences
# University of Texas at Austin
# University Station, Box X
# Austin, TX 78713-8924
# 
# 512-471-1534 (voice)
# 512-471-0140 (fax)
# mailto:jim.jennings@beg.utexas.edu
# http://www.beg.utexas.edu/staffinfo/jennings01.htm
#
# February 2006
#

#
# Setting up
#

from rsfproj import *
import spatial_stats

par = [{},{},{}]    # data file parameters

par[0] = {  'ind':  'ex1D_ind',                 # data indicator filename
            'val':  'ex1D_val',                 # data values filename
            'nx':  16, 'ny':   1, 'nz':   1,    # array sizes
            'dx':   1, 'dy':   1, 'dz':   1     # cell sizes
         }
                  
par[1] = {  'ind':  'ex2D_ind',                 # data indicator filename
            'val':  'ex2D_val',                 # data values filename
            'nx':  16, 'ny':   8, 'nz':   1,    # array sizes
            'dx':   1, 'dy':   1, 'dz':   1     # cell sizes
         }
                  
par[2] = {  'ind':  'ex3D_ind',                 # data indicator filename
            'val':  'ex3D_val',                 # data values filename
            'nx':  16, 'ny':   8, 'nz':   4,    # array sizes
            'dx':   1, 'dy':   1, 'dz':   1     # cell sizes
         }

#
# Calculate the variograms
#

for i in range(3): 
    spatial_stats.variogram(par[i])

#          
# 1D plots
#
 
plots1 = ['ex1D_ind','ex1D_val','ex1D_val_pairs','ex1D_val_var']

if (par[0]['nx'] > 50):
    circles = ''
else:
    circles = 'symbol="o" symbolsz=10'
    
for i in (plots1):
    Result (i,'graph title="%s" %s' % (i,circles) )

#          
# 2D plots	
#          
    
plots2 = ['ex2D_ind','ex2D_val','ex2D_val_pairs','ex2D_val_var']

screen_ratio  = ( float(par[1]['ny']*par[1]['dy'])
                 /float(par[1]['nx']*par[1]['dx']) )
screen_height = 10
if (screen_height/screen_ratio > 13):
    screen_height = 13*screen_ratio

for i in (plots2):
    Result (i,
            '''
            grey title="%s" transp=n yreverse=n allpos=y
            pclip=100 color=j wantscalebar=y gainpanel=a
            screenratio=%g screenht=%g
            ''' % (i,screen_ratio,screen_height) )

#          
# 3D plots
#          

plots3 = ['ex3D_ind','ex3D_val','ex3D_val_pairs','ex3D_val_var']

for i in (plots3):
    Result (i,
            '''
            transp plane=12 | transp plane=13 | reverse which=1 |
            byte bar=bar.rsf gainpanel=all pclip=100 wantscalebar=y allpos=y |
            grey3 title="%s" 
            color=j movie=0 flat=y scalebar=y bar=bar.rsf
            frame1=%d frame2=%d frame3=%d point1=0.5 point2=0.5 > $TARGET &&
            rm -f bar.rsf
            ''' % (i,par[2]['nz']/2,
                     par[2]['nx']/2,
                     par[2]['ny']/2) , stdout=0
           )

End ()
