from rsf.proj import *

Flow('vel',None,
     	'''
     	math output=1000 n1=301 n2=301 d1=1 d2=1
     	label1=x1 unit1=m label2=x2 unit2=m 
     	''')
Flow('rho','vel','math output=1000')
Flow('eta','vel','math output=100000000')

nb=30
nt=200
dt=0.0005
fm=30

Flow('wav','vel rho eta',
	'''
	sfmaxwell_cpml2 rho=${SOURCES[1]} eta=${SOURCES[2]} order1=y
	nb=%d nt=%d dt=%g verb=y fm=%g
	'''%(nb,nt,dt,fm))
Result('wav',
	'''	
	grey  title="Mexwell Attenuation Model" gainpanel=all
	color=i screenratio=1
	''')

###################################################################
# 1st order without attenuation
#sfmaxwell_direct_backward,sfmaxwell_sponge2_backward
Flow('wf1 wb1 ef1 eb1','vel rho eta',
	'''
	sfmaxwell_cpml2_backward rho=${SOURCES[1]} eta=${SOURCES[2]}
	back=${TARGETS[1]} ef=${TARGETS[2]} eb=${TARGETS[3]} 
	attenuating=n order1=y	nb=%d nt=%d dt=%g verb=y fm=%g
	'''%(nb,nt,dt,fm))
Result('wf1',
	'''	
	grey  title="forward:1st order, no attenuation" gainpanel=all
	color=i screenratio=1 labelfat=2 titlefat=3
	''')
Result('wb1',
	'''	
	grey  title="backward:1st order, no attenuation" gainpanel=all
	color=i screenratio=1 labelfat=2 titlefat=3
	''')

Plot('energy1','ef1 eb1',
	'''
	cat axis=2 ${SOURCES[1]}|
	graph dash=0,1 grid=y plotfat=3 label1=Time unit1=s
	label2="No attenuation,1st order"  
	unit2= title="Forward-solid;Backward-dash"
	color=i screenratio=1 labelfat=2 titlefat=3
	''')
###################################################################
#1st order with attenuation
#sfmaxwell_direct_backward,sfmaxwell_sponge2_backward
Flow('wf2 wb2 ef2 eb2','vel rho eta',
	'''
	sfmaxwell_cpml2_backward rho=${SOURCES[1]} eta=${SOURCES[2]}
	back=${TARGETS[1]} ef=${TARGETS[2]} eb=${TARGETS[3]} 
	attenuating=y order1=y	nb=%d nt=%d dt=%g verb=y fm=%g
	'''%(nb,nt,dt,fm))
Result('wf2',
	'''	
	grey  title=" forward:1st order, attenuation" gainpanel=all
	color=i screenratio=1 labelfat=2 titlefat=3
	''')
Result('wb2',
	'''	
	grey  title="backward:1st order, attenuation" gainpanel=all
	color=i screenratio=1 labelfat=2 titlefat=3
	''')

Plot('energy2','ef2 eb2',
	'''
	cat axis=2 ${SOURCES[1]}|
	graph dash=0,1 grid=y plotfat=3 label1=Time unit1=s
	label2="Attenuation,1st order"  
	unit2= title="Forward-solid;Backward-dash"
	color=i screenratio=1 labelfat=2 titlefat=3
	''')


###################################################################
#2nd order without attenuation
#sfmaxwell_direct_backward,sfmaxwell_sponge2_backward
Flow('wf3 wb3 ef3 eb3','vel rho eta',
	'''
	sfmaxwell_cpml2_backward rho=${SOURCES[1]} eta=${SOURCES[2]}
	back=${TARGETS[1]} ef=${TARGETS[2]} eb=${TARGETS[3]} 
	attenuating=n order1=n	nb=%d nt=%d dt=%g verb=y fm=%g
	'''%(nb,nt,dt,fm))
Result('wf3',
	'''	
	grey  title="forward:2nd order, no attenuation" gainpanel=all
	color=i screenratio=1 labelfat=2 titlefat=3
	''')
Result('wb3',
	'''	
	grey  title="backward:2nd order, no attenuation" gainpanel=all
	color=i screenratio=1 labelfat=2 titlefat=3
	''')

Plot('energy3','ef3 eb3',
	'''
	cat axis=2 ${SOURCES[1]}|
	graph dash=0,1 grid=y plotfat=3 label1=Time unit1=s
	label2="No attenuation,2nd order"  
	unit2= title="Forward-solid;Backward-dash"
	color=i screenratio=1 labelfat=2 titlefat=3
	''')

###################################################################
#2nd order with attenuation
#sfmaxwell_direct_backward,sfmaxwell_sponge2_backward
Flow('wf4 wb4 ef4 eb4','vel rho eta',
	'''
	sfmaxwell_cpml2_backward rho=${SOURCES[1]} eta=${SOURCES[2]}
	back=${TARGETS[1]} ef=${TARGETS[2]} eb=${TARGETS[3]} 
	attenuating=y order1=n	nb=%d nt=%d dt=%g verb=y fm=%g
	'''%(nb,nt,dt,fm))
Result('wf4',
	'''	
	grey  title=" forward:2nd order, attenuation" gainpanel=all
	color=i screenratio=1 labelfat=2 titlefat=3
	''')
Result('wb4',
	'''	
	grey  title="backward:2nd order, attenuation" gainpanel=all
	color=i screenratio=1 labelfat=2 titlefat=3
	''')

Plot('energy4','ef4 eb4',
	'''
	cat axis=2 ${SOURCES[1]}|
	graph dash=0,1 grid=y plotfat=3 label1=Time unit1=s
	label2="Attenuation,2nd order"  
	unit2= title="Forward-solid;Backward-dash"
	color=i screenratio=1 labelfat=2 titlefat=3
	''')
Result('energy','energy1 energy2 energy3 energy4','TwoColumns')

End()
