from rsfproj import *

# On wedge: Robertson and Nogami, Complex seismic trace analysis of thin beds
# Geophysics, 1984, v. 49, no. 4, 344-352.
#
# Robertson and Fisher, Complex seismic trace attributes
# TLE, 1988, no. 6, 22-26

freq=25 # Frequency in Hz

Flow('top',None,'math n1=300 d1=1 o1=0 output=%g' % (3.0/freq))
Flow('bot','top','math output="input*(2-x1/%d)" ' % 299)
Flow('wedge','top bot',
     '''
     cat axis=2 ${SOURCES[1]} |
     unif2 n1=%d o1=0 d1=0.001 v00=10,5,10
     ''' % int(1+(9.0/(freq*0.001))))
Result('wedge',
       '''
       grey color=j title="Wedge Model"
       scalebar=y barlabel="Velocity (kft/s)"
       allpos=y
       ''')

Flow('wseis','wedge','ai2refl | ricker1 frequency=%g' % freq)
Result('wseis','grey title=Seismic color=G')

shifts = []
for a in range(-180,190,10):
    shift = 'shift%d' % a
    shifts.append(shift)
    Flow(shift,'wseis','envelope hilb=y phase=%d' % a)
Flow('wshift',shifts,'cat ${SOURCES[1:%d]} | put o3=-180 d3=10' % len(shifts))

Flow('wfoc','wshift','focus rect1=100 rect2=100')

for rect in (1,100):
    freq = 'wfreq%d' % rect
    Flow(freq,'wseis',
         'iphase rect1=%d rect2=%d order=50 hertz=y' % (rect,rect))
    Result(freq,
           '''
           grey color=j scalebar=y
           title="Instantaneous Frequency %d"
           clip=60 allpos=y minval=0 maxval=60
           ''' % rect)
       
End()
