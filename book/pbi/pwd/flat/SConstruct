from rsfproj import *

import os
private = {'login':os.environ.get('BEG_LOGIN'),
           'password':os.environ.get('BEG_PASSWORD'),
           'server':os.environ.get('BEG_SERVER')}

Fetch(['acig10.hh','cmp.hh'],'acig',private)

Flow('acig','acig10.hh','dd form=native | window n3=1')
Plot('acig','grey title="Angle Common-Image Gather" ')

Flow('dip','acig','dip rect1=10 rect2=3')
Flow('dso','acig dip','flat dip=${SOURCES[1]}')
Plot('dso','grey title=Flattened')

Flow('pick','dip','pick0')

for plot in [0,1]:
    Plot('pick%d' % plot,'pick',
         '''
         window j2=40 |
         graph yreverse=y plotcol=%d plotfat=%d
         min1=0 max1=31 min2=0 max2=800
         wanttitle=n wantaxis=n
         ''' % ((0,5)[plot],(10,1)[plot]))
Plot('acig0','acig pick0 pick1','Overlay')
Result('acig','acig acig0 dso','SideBySideAniso')

Flow('cmp','cmp.hh',
     '''
     dd form=native |
     tpow tpow=2 |
     nmostretch half=n v0=1.5 |
     mutter half=n v0=1.8
     ''')
Plot('cmp','grey title="CMP Gather" ')

Flow('cmp-dip','cmp','pad n2=100 | dip rect1=20 rect2=10')
Flow('cmp-dso','cmp cmp-dip',
     'pad n2=100 | flat dip=${SOURCES[1]} | window n2=60')
Plot('cmp-dso','cmp-dso','grey title=Flattened')

Flow('cmp-pick','cmp-dip','window n2=60 | pick0')

for plot in [0,1]:
    Plot('cmp-pick%d' % plot,'cmp-pick',
         '''
         window j2=40 |
         graph yreverse=y plotcol=%d plotfat=%d
         min1=0 max1=59 min2=0 max2=999
         wanttitle=n wantaxis=n
         ''' % ((0,5)[plot],(10,1)[plot]))
Plot('cmp0','cmp cmp-pick0 cmp-pick1','Overlay')
Result('cmp','cmp cmp0 cmp-dso','SideBySideAniso')

Flow('sigmoid',None,
     '''
     sigmoid n1=200 n2=210 d2=0.008 |
     smooth rect1=3 diff1=1 | smooth rect1=3
     ''')
Plot('sigmoid','grey title=Input')

Result('sigin','sigmoid','grey title=Input scalebar=y')
Result('sigin2','sigmoid','grey title=Input')

Flow('sdip','sigmoid',
     'dip order=2 p0=0 verb=y niter=10 rect1=3 rect2=3')
Flow('sdip0','sigmoid','dip p0=0 verb=y rect1=1 rect2=1')

Result('sigdip','sdip','grey color=j title="Smooth Dip" scalebar=y')
Result('sigdip0','sdip0','grey color=j title="Unsmoothed Dip" scalebar=y')

Flow('spwd','sigmoid sdip',
     'pwd dip=${SOURCES[1]} order=2 | smooth rect3=3')
Result('sigpwd','spwd','grey title=Residual')

Flow('sflat','sigmoid sdip','flat dip=${SOURCES[1]} i0=105 eps=0.05')
Plot('sflat','sflat','grey title=Flattened')

Result('sflat','sigmoid sflat','SideBySideAniso')

Result('sigflt','sflat','grey title=Flattened')
    
###########################################################################
End()
