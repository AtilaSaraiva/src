from rsfproj import *

Flow('sigmoid',None,
     '''
     sigmoid n1=200 n2=210 d2=0.008 |
     smooth rect1=3 diff1=1 | smooth rect1=3 |
     bandpass fhi=60
     ''')
Flow('orig','sigmoid','window n2=209')
Plot('sigmoid','orig','grey title=Original clip=0.003')
Flow('sigmoid-dec','sigmoid','window j2=2')
Plot('sigmoid-dec','sigmoid-dec','grey title=Decimated clip=0.003')
Plot('sigmoid-top','sigmoid sigmoid-dec','SideBySideAniso')

title = {'sigmoid':'Original',
         'sigmoid-dec':'Decimated',
         'aliasp': 'Input',
         'dealiasp': 'Output'}

for input in ['sigmoid','sigmoid-dec']:
    dip = input + '-dip'     
    Flow(dip,input,'dip rect1=3 rect2=3 nj1=%d' % (2,1)[input=='sigmoid'])
    Plot(dip,
         'grey color=j scalebar=y title=%s' % title[input])
Result('dip',['sigmoid-dip','sigmoid-dec-dip'],'SideBySideAniso')

res = 'res'
err = 'err'
bot = 'bot'

Flow(res,'sigmoid-dec sigmoid-dec-dip','dealias2 dip=${SOURCES[1]}')
Plot(res,'grey title=Restored clip=0.003')
Plot(err,[res,'orig'],
     'add scale=1,-1 ${SOURCES[1]} | grey title=Error clip=0.003')
Plot(bot,[res,err],'SideBySideAniso')
Result('sigmoid',['sigmoid-top',bot],'OverUnderAniso')

###########################################################################

End()
