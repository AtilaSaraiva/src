from rsfproj import *

Flow('r',None,'spike n1=201 nsp=4 k1=25,75,125,175 mag=1,-1,0.5,-0.5 d1=1 label1=Sample unit1=')
Flow('d','r','math output="-sin(0.05*x1)" ')
Flow('n','d r','add mode=p ${SOURCES[1]} | noise seed=2007 var=0.004')

Result('dat','n d r','cat axis=2 ${SOURCES[1:3]} | dots labels=numerator:denominator:ratio gaineach=n yreverse=n')

Flow('r0','r','math output=1')
eps = 0.008

for i in range(10):
    r0 = 'r%d' % i
    r  = 'r%d' % (i+1)
    Flow(r,['n','d',r0],'math d=${SOURCES[1]} r=${SOURCES[2]} output="input*d*r*r/(d*d*r*r+%g)" ' % eps)

Result('rat','r1 r2 r3 r10','cat axis=2 ${SOURCES[1:4]} | dots labels=iter=1:iter=2:iter=3:iter=10 gaineach=n yreverse=y')

End()
