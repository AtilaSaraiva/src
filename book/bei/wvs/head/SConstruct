from rsfproj import *

n1 = {
    '34': 400,
    '32': 400,
    '20': 450
    }

for case in ('34','32','20'):
    data = 'wz.%s.H' % case
    Fetch(data,'wz')
    Flow(case,data,'dd data_format=native_float')
    
    window = 'window n1=%d | tpow xpow=1 tpow=0' % n1[case]
    raw = 'raw'+case
    lmo = 'lmo'+case
    
    Flow(raw,case,window)
    Plot(raw,raw,'grey wanttitle=n')
    
    Flow(lmo,case,'lmostretch delay=1 v0=1.47 half=n | ' + window)
    Plot(lmo,lmo,'grey wanttitle=n')

    Result('wzl.'+case,[raw,lmo],'SideBySideAniso',vppen='txscale=1.5')

Fetch('midpts.HH','midpts')
Flow('cdp','midpts.HH','window n3=1 n1=300 j1=2 | dd data_format=native_float')
Flow('lmo','cdp','lmostretch delay=0.4 v0=1.47 half=n')

wiggle = '''
wiggle pclip=100 zplot=1.
title="%s" transp=y yreverse=y
label1="Time (s)" label2="Offset (km)"
'''

Plot('cdp','cdp',wiggle % ' ')
Plot('lmo','lmo',wiggle % 'LMO')
Result('wglmo','cdp lmo','SideBySideAniso',vppen='txscale=1.5')

###########################################################################
End()
