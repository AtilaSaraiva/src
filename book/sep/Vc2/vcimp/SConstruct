from rsfproj import *

Flow('spike',None,
     '''
     spike n1=256 n2=256 d1=0.004 d2=0.008
     nsp=3 k1=100,150,200 k2=100,150,200 |
     bandpass flo=10 fhi=50
     ''')

for case in (0,1):
    imp = 'imp%d' % case
    Flow(imp,'spike',
         '''
         pad n2=500 | velcon vel=1 v0=0 nv=3000 inv=%d adj=%d | window n2=256
         ''' % (case,1-case))
    Plot(imp,
         'grey title="Finite-diff impulse response, dv=%d km/s" ' % (1-2*case))
Result('fd-imp','imp0 imp1','SideBySideIso')

End()
