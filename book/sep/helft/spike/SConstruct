from rsf.proj import *

Flow('spike',None,
     'spike d1=1. d2=1. n1=100 n2=100 k1=24 k2=13 nsp=1 label1=X unit1=m label2=Y unit2=m')
Plot('spike','grey titlesz=15 labelsz=10 crowd=0.78 pclip=100 title="(a)" ')

# 2-D FFT
Flow('spike-fft2','spike',
     'pad n1=1024 n2=1024 | rtoc | fft3 axis=1 pad=1 | fft3 axis=2 pad=1')

# 1-D helix FFT
Flow('spike-fft','spike',
     'pad n1=1024 n2=1024 | put n2=1 n1=1048576 | rtoc | fft3 axis=1 pad=1 | put n1=1024 n2=1024 | transp')
Flow('spike-left','spike-fft','window n2=512')
Flow('spike-rite','spike-fft','window f2=512 n1=1023 | pad beg1=1')
Flow('spike-fft1','spike-rite spike-left',
     'cat axis=2 ${SOURCES[1]} | put d1=0.0976562 o1=-50 d2=0.0976562 o2=-50 label1=Wavenumber unit1=1/m')


End()
