\author{Leonard Euler} 
%%%%%%%%%%%%%%%%%%%%%%
\title{Homework 2}

\begin{abstract}
This homework has two parts. In the theoretical part, you will derive
analytical solutions for one-point and two-point ray tracing problems
in a medium with a constant gradient of velocity. In the computational
part, you will experiment with a real marine dataset from offshore
Florida.
\end{abstract}

\section{Introduction}

Start by running
\begin{verbatim}
> cd ~/geo391
> svn update
\end{verbatim}

\section{Theoretical part}

You can either write your answers on paper or edit them in
\verb#~/geo391/hw2/paper.tex#. Please show all the mathematical
derivations that you do.

\begin{enumerate}
\item In class, we used a mysterious parameter $\sigma$ to represent a
  variable continuously increasing along a ray. There are other
  variables that can play a similar role.
\begin{enumerate}
\item Use the chain rule $\frac{d}{d \sigma} = \frac{d}{d T}\,\frac{d
T}{d \sigma}$ to transform the isotropic ray tracing system
\begin{eqnarray}
\label{eq:xsigma}
\frac{d \mathbf{x}}{d \sigma} & = & \mathbf{p} \\
\label{eq:psigma}
\frac{d \mathbf{p}}{d \sigma} & = & S(\mathbf{x})\,\nabla S \\
\label{eq:tsigma}
\frac{d T}{d \sigma} & = & S^2(\mathbf{x})
\end{eqnarray}
into the equivalent system
\begin{eqnarray}
\label{eq:xt}
\frac{d \mathbf{x}}{d T} = & & \hfill \\
\label{eq:pt}
\frac{d \mathbf{p}}{d T} = & & \hfill
\end{eqnarray}
that uses time $T$ as the ray parameter. Check physical dimensions.
\item Use the chain rule to find a parameter $\xi$ such that
\begin{equation}
\label{eq:pxi}
\frac{d \mathbf{p}}{d \xi} = - \nabla V = \frac{\nabla S}{S^2(\mathbf{x})}
\end{equation}
What are the physical dimensions of $\xi$?
\item Show that
\begin{equation}
  \label{eq:txi}
  \frac{d T}{d \xi} = V(\mathbf{x})\;,
\end{equation}
where $V=1/S$ is the velocity.
\item Find
\begin{eqnarray}
  \label{eq:xxi}
  \frac{d \mathbf{x}}{d \xi} = & & \hfill 
\end{eqnarray}
\end{enumerate}
\item We will use a new $\xi$ parameterization to solve the ray
tracing problem analytically for the special case when the velocity
distribution has a constant gradient
\begin{equation}
  \label{eq:v}
  V(\mathbf{x}) = V(\mathbf{x}_0) + \mathbf{g}_0 \cdot (\mathbf{x} - \mathbf{x}_0)\;.
\end{equation}
\begin{enumerate}
\item Solving the one-point ray tracing problem for $\mathbf{x}(\xi)$
and $\mathbf{p}(\xi)$ with the initial conditions  $\mathbf{x}(0)=\mathbf{x}_0$ and
 $\mathbf{p}(0)=\mathbf{p}_0$, show that
\begin{equation}
\label{eq:psol}
\mathbf{p}(\xi) = \mathbf{p}_0 - \mathbf{g}_0\,\xi\;.
\end{equation}
\item Express
\begin{eqnarray}
\label{eq:vsol}
V(\mathbf{x}) = \frac{1}{S(\mathbf{x})} = \frac{1}{\sqrt{\mathbf{p} \cdot \mathbf{p}}} = & &
\end{eqnarray}
in terms of $\mathbf{g}_0$, $\mathbf{p}_0$ and $\xi$.
\item Define $a = \mathbf{p} \cdot (\mathbf{x} - \mathbf{x}_0)$. Find
\begin{eqnarray}
\label{eq:axi}
\frac{d a}{d \xi} = & & 
\end{eqnarray}
and show that 
\begin{equation}
\label{eq:asol}
a(\xi) = V(\mathbf{x}_0)\,\xi
\end{equation}
and
\begin{equation}
\label{eq:a0sol}
\mathbf{p}_0 \cdot (\mathbf{x} - \mathbf{x}_0) = V(\mathbf{x})\,\xi
\end{equation}
\item One way to seek the solution for the one-point ray tracing
  problem is to look for scalars $\alpha$ and $\beta$ in the representation
\begin{equation}
  \label{eq:xsol}
  \mathbf{x}(\xi) = \mathbf{x}_0 + \alpha(\xi)\,\mathbf{p}_0 + \beta(\xi)\,\mathbf{g}_0\;.
\end{equation}
Under what condition does the linear system of equations
\begin{eqnarray}
  \label{eq:linsys1}
  V(\mathbf{x})\,\xi = \mathbf{p}_0 \cdot (\mathbf{x} - \mathbf{x}_0) & = & 
  \alpha\,\mathbf{p}_0 \cdot \mathbf{p}_0 + \beta\,\mathbf{p}_0 \cdot \mathbf{g}_0 \\
  \label{eq:linsys2}
  V(\mathbf{x}) - V(\mathbf{x}_0) = \mathbf{g}_0 \cdot (\mathbf{x} - \mathbf{x}_0) & = &
  \alpha\,\mathbf{p}_0 \cdot \mathbf{g}_0 + \beta\,\mathbf{g}_0 \cdot \mathbf{g}_0
\end{eqnarray}
have a unique solution for $\alpha$ and $\beta$?
\end{enumerate}

\newpage

\item (EXTRA CREDIT) For an extra credit, solve the
  two-point ray tracing problem. 
\begin{enumerate}
\item Find $\alpha$ and $\beta$ from
  equations~(\ref{eq:linsys1}-\ref{eq:linsys2}).
\item Express the squared distance between the ray end points
  \begin{eqnarray}
  \nonumber
    |\mathbf{x} - \mathbf{x}_0|^2 & = & (\mathbf{x} - \mathbf{x}_0) \cdot (\mathbf{x} - \mathbf{x}_0) =
    \alpha^2\,\mathbf{p}_0 \cdot \mathbf{p}_0 + 2 \alpha\,\beta\,\mathbf{p}_0 \cdot \mathbf{g}_0 +
    \beta^2\,\mathbf{g}_0 \cdot \mathbf{g}_0 \\
    & = & 
    \label{eq:d2} 
  \end{eqnarray}
  in terms of $\mathbf{g}_0$, $\mathbf{p}_0$, and $\xi$. 
\item In the two-point problem, the two unknown
  parameters are $\xi$ and $(\mathbf{p}_0 \cdot \mathbf{g}_0)$.
  Express $(\mathbf{p}_0 \cdot \mathbf{g}_0)$ from your
  equation~(\ref{eq:vsol}) and substitute it into your
  equation~(\ref{eq:d2}). Solve for $\xi$. How many physically
  meaningful solutions can you obtain?
\item Finally, use $\xi$ and $(\mathbf{p}_0 \cdot \mathbf{g}_0)$ 
  expressed in terms of $|\mathbf{x} - \mathbf{x}_0|$,
  $|\mathbf{g}_0|$, $V(\mathbf{x}_0)$, and $V(\mathbf{x})$ and
  substitute them into the one-point traveltime solution obtained by
  integrating equation~(\ref{eq:txi})\footnote{$\mbox{arccosh}(x)$ is
  the inverse hyperbolic cosine function defined as $\mbox{arccosh}(x)
  = \ln\left(x + \sqrt{x^2-1}\right)$.}  
  \begin{equation}
  \label{eq:t1} T(\xi) =
  \frac{1}{|\mathbf{g}_0|}\,\mbox{arccosh}\left(1 +
  \frac{|\mathbf{g}_0|^2\,V(\mathbf{x})\,V^2(\mathbf{x}_0)\,\xi^2}
  {V(\mathbf{x})+V(\mathbf{x}_0) - (\mathbf{p}_0 \cdot
  \mathbf{g}_0)\,V(\mathbf{x})\,V^2(\mathbf{x}_0)\,\xi}\right)\;.
  \end{equation} 
Your result will be the analytical two-point
  traveltime \begin{eqnarray} \label{eq:t2}
  \widehat{T}(\mathbf{x}_0,\mathbf{x}) = & & \hfill \ \end{eqnarray}
\end{enumerate}
\end{enumerate}

\section{Computational part}

\inputdir{blake}

In the computational part, we begin working with a real data
set. The dataset is a 2-D line from the Blake Outer Ridge area
offshore Florida. It was collected by USGS in order to study the
occurrence of methane hydrates. The dataset and its analysis for gas
hydrate detection are described by
\cite{GEO63-05-16591669,GEO65-02-05650573}.

Figure~\ref{fig:cmp} shows an example CMP (common midpoint) gather
from the dataset. Note the change in the trace spacing caused by using
a non-linear cable in the acquisition. The presence of gas hydrates is
manifested by a so-called BSR (bottom-simulating reflector). You can
get an idea of the spatial extent of BSR from the near-offset section
in Figure~\ref{fig:noff}.

\plot{cmp}{width=\textwidth}{CMP (common midpoint) gather from the Blake Outer Ridge dataset. 
The presence of gas hydrates is manifested by BSR (bottom-simulating
reflector).}

\sideplot{noff}{width=\textwidth}{Near offset section of the Blake Outer Ridge data.}

We will use a very simple model to try explaining the geometry of the
observed events in the data. The left plot in Figure~\ref{fig:ray}
shows the model and rays from two-point ray tracing. The model
consists of a constant velocity water layer and sedimentary layer that
contains BSR with a slowly variable velocity. The right plot in
Figure~\ref{fig:ray} shows the CMP gather and traveltime curves
obtained by ray tracing. 

\plot{ray}{width=\textwidth}{Left: A two-layer model and ray trajectories. 
Right: A CMP gather and traveltime curves.}

Your task is to modify the model so that the predicted traveltime
curves match the geometry of the sea bottom and the BSR reflection
observed in the data.

\begin{enumerate}
\item Change directory 
\begin{verbatim}
> cd ~/geo391/hw2/blake
\end{verbatim}
\item Run
\begin{verbatim}
> scons view
\end{verbatim}
to generate figures and display them on your screen.  
\item Edit the
top of the \texttt{SConstruct} file to modify the model
parameters. Check your result by running
\begin{verbatim}
> scons ray.view
\end{verbatim}
or (equivalently)
\begin{verbatim}
> scons Fig/ray.vpl
> xtpen Fig/ray.vpl
\end{verbatim}
\item After you are done, run
\begin{verbatim}
> scons lock
> cd ..
\end{verbatim}
\item Edit the file
\verb#~/geo391/hw2/paper.tex# in your favorite editor and change the
first line to have your name instead of Euler's. Run
\begin{verbatim}
> scons pdf
\end{verbatim}
and submit your result (file \texttt{paper.pdf}) on paper or by
e-mail.
\end{enumerate}

\bibliographystyle{seg} \bibliography{SEG}
