from rsf.proj import *

# Download data
Fetch('austin-w.HH','bay')

# Convert to byte form
Flow('byte','austin-w.HH',
     '''
     dd form=native |
     byte pclip=100 allpos=y
     ''')

# Display
Result('byte',
       '''
       grey yreverse=n screenratio=1 
       title="Digital Elevation Map" 
       ''')

# Histogram
Flow('hist','byte',
     '''
     dd type=float |
     histogram n1=256 o1=0 d1=1 |
     dd type=float
     ''')
Plot('hist',
     'graph label1=Value label2=Occurence title=Histogram')

# Cumulative histogram
Flow('cumu','hist','causint')

Result('hist','hist cumu',
       '''
       cat axis=2 ${SOURCES[1]} | scale axis=1 |
       graph label1=Value label2="Normalized Occurence"
       title=Histogram dash=0,1
       ''')

# ADD HISTOGRAM EQUALIZATION


# Variogram
Flow('vari','byte',
     '''
     dd type=float |
     variogram dh=4 oh=10 semi=y
     ''')
Result('vari',
       '''
       window n2=1 f2=600 | 
       graph min2=0 label2=Variance title=Variogram
       ''')

# Horizontal variogram
Flow('vari2','byte',
     '''
     dd type=float |
     variogram2 dh1=10 oh1=10 dh2=10 oh2=10 semi=y verb=y
     ''')

Plot('contour','vari2',
     'contour scalebar=y screenratio=1 yreverse=n wantaxis=n wanttitle=n')
Plot('vari2',
     '''
     grey color=j bias=5000 title="Horizontal variogram"
     yreverse=n screenratio=1 scalebar=y
     ''')
Result('vari2','vari2 contour','Overlay')


End()
