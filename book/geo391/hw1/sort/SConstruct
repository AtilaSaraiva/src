from rsf.proj import *

# Generate random data
Flow('rand',None,
     'spike n1=409600 | noise rep=y type=n seed=2010')

prog = Program('sort.c')

sort = 'slow'

# !!! UNCOMMENT THE NEXT LINE
# sort = 'quick' 

# Sorting movie
Flow('movie','rand %s' % prog[0],
     '''
     window n1=100 | 
     ./${SOURCES[1]} movie=$TARGET type=%s
     ''' % sort,stdout=0)
Plot('movie',
     '''
     graph symbol=* title="%s Sort" wantaxis=n symbolsz=10
     ''' % sort.capitalize(),view=1)

# Sorting cost
na = 100
costs = []
for n in range(12):
    na *= 2
    cost = 'cost%d' % n
    Flow(cost,'rand  %s' % prog[0],
         'window n1=%d | ./${SOURCES[1]} type=%s' % (na,sort))
    costs.append(cost)
Flow('cost',costs,
     'cat axis=1 ${SOURCES[1:12]} | put o1=1 d1=1 unit1=')
    
Result('cost',
       '''
       math output="log(input+0.01)/log(2)" |
       graph title=Cost min2=0
       label1="log(N/100)" label2="log(CPU Cycles)" 
       ''')

End()
