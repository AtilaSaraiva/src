\author{Gustav Kirchhoff}
%%%%%%%%%%%%%%%%%%%%%%
\title{Homework 5}

\begin{abstract}
In this lab, you will derive analytical expressions for geometrical
spreading in layered media and experiment with creating angle gathers
by wave equation migration.
\end{abstract}

\definecolor{frame}{rgb}{0.905,0.905,1.0}
\lstset{language=Python,backgroundcolor=\color{frame},showstringspaces=false}

\section{Theoretical part}

In a layered isotropic medium with a $V(z)$ velocity distribution, the
traveltime and the offset of the reflected wave are given by
\begin{eqnarray}
  \label{eq:t}
  t(p) & = & 2\,\int\limits_{0}^{H} \frac{d z}{V(z)\,\sqrt{1-p^2\,V^2(z)}} \\
  \label{eq:x}
  x(p) & = & 2\,\int\limits_{0}^{H} \frac{p\,V(z)\,d z}{\sqrt{1-p^2\,V^2(z)}}\;,
\end{eqnarray}
where $H$ is the reflector depth, and $p$ is the horizontal component
of the slowness vector in the reflection plane $p = \partial
t/\partial x$. 

\begin{enumerate}
\item Prove that the geometrical amplitude of the reflection
  wave in the 3-D case is
\begin{equation}
  \label{eq:a3}
  A(p) = \frac{R(p)\,V(0)\,\sqrt{V(0)\,\rho(0)}}{2\,\sqrt{1-p^2\,V^2(z)}}\,
    \left[\int\limits_{0}^{H} \frac{V(z)\,d z}{\sqrt{1-p^2\,V^2(z)}}\,
      \int\limits_{0}^{H} \frac{V(z)\,d z}{\left(1-p^2\,V^2(z)\right)^{3/2}}
    \right]^{-1/2}\;,
\end{equation}
where $R(p)$ is the reflection coefficient.

\textbf{Hint:} Rewrite equation~(\ref{eq:x}) as
\begin{equation}
  \label{eq:x3}
  \mathbf{x}(\mathbf{p}) = 2\,\int\limits_{0}^{H} \frac{\mathbf{p}\,V(z)\,d z}{\sqrt{1-\mathbf{p} \cdot \mathbf{p}\,V^2(z)}}\;,
\end{equation}
where vectors $\mathbf{x}$ and $\mathbf{p}$ have two horizontal
components and evaluate the result at $\mathbf{p}=\{p,0\}$.
 
\item Derive the corresponding expression for the amplitude in the 2-D case.
\begin{equation}
  \label{eq:a2}
  A(p) =
\end{equation}

\end{enumerate}

\section{Computational part}

\inputdir{hyper}

Figure~\ref{fig:hyper,image} shows the model of a reflector and an
image generated by wave-equation imaging of three shot gathers
depicted in Figure~\ref{fig:shots}. The shot gathers are generated by
Kirchhoff modeling.

\multiplot{2}{hyper,image}{width=0.45\textwidth}{Reflector model (a)
  and a wave-equation image (b) using three synthetic shot gathers.}

\plot{shots}{width=0.9\textwidth}{Synthetic shot gathers generated by
  Kirchhoff integral modeling. Analytical reflection traveltime curves
  are overlaid on top of the reflections.}

\begin{enumerate}

\item Start by running
\begin{verbatim}
> cd ~/geo391
> svn update
\end{verbatim}
    
\item Change directory 
\begin{verbatim}
> cd ~/geo391/hw5/hyper
\end{verbatim}
\item Run
\begin{verbatim}
> scons view
\end{verbatim}
to generate figures and display them on your screen.  

\item

Figure~\ref{fig:cigs} shows three angle-domain common image gathers
for three image locations extracted from wave-equation migration.
Explain the appearance of angle gathers.  Why does each shot gather
generates only one point on an angle gather? You can use a sketch of
incident and reflection rays in the explanation.

\plot{cigs}{width=0.9\textwidth}{Angle-domain common image gathers
  for three image locations extracted from wave-equation migration.}

\item Edit the \texttt{SConstruct} file to change the plane reflector
  to a hyperbolic reflector (uncomment the line with \texttt{b}
  parameter). Repeat the computations.

\begin{enumerate}
\item You will need to change the analytical traveltime formula in
  \texttt{SConstruct} to match the new reflection traveltimes in
  Figure~\ref{fig:shots}.  \textbf{Hint:} Use equations from Homework
  3.
\item Explain the change in the appearance of angle gathers. You can
  use a sketch of incident and reflection rays in the explanation. 
\item Modify the \texttt{SConstruct} file to move the shot positions
  at the surface so that the image point at $-0.5$~km is illuminated at
  a reflection angle $\theta$ such that $\tan{\theta}=0.5$.
\end{enumerate}

\item After you are done, run
\begin{verbatim}
> scons lock 
> scons -c
\end{verbatim}

\item Edit the file
  \verb#~/geo391/hw5/paper.tex# in your favorite editor and change the
first line to have your name instead of Kirchhoff's. Run
\begin{verbatim}
> scons pdf
\end{verbatim}
and submit your result (file \texttt{paper.pdf}) on paper or by
e-mail.

\end{enumerate}

{\tiny
\lstinputlisting[frame=single]{hyper/SConstruct}
}
