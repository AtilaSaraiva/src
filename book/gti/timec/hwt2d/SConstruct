from rsfproj import *

# ------------------------------------------------------------
# ------------------------------------------------------------
#par = {
#    'nz':100, 'dz':4,     'oz':0,
#    'nx':100, 'dx':4,     'ox':0,
#    'nt':100, 'dt':0.001, 'ot':0,
#    'ng':360, 'dg':1.   , 'og':-180
#    }
# ------------------------------------------------------------
#Flow('vel',None,
#     '''
#     spike nsp=1 mag=2000
#     n1=%(nz)d d1=%(dz)g o1=%(oz)g
#     n2=%(nx)d d2=%(dx)g o2=%(ox)g
#     ''' % par)
#Plot('vel','grey allpos=y' %par,view=1)
#Flow('wft','vel',
#     '''
#     hwt2d verb=y
#     nt=%(nt)d ot=%(ot)g dt=%(dt)g
#     ng=%(ng)d og=%(og)g dg=%(dg)g
#     ''' % par)
#Result('wft','window | transp | graph' % par)



# ------------------------------------------------------------
# ------------------------------------------------------------
mpar = {
    'nz':375, 'dz':8,    'oz':0,   'zmin':0,   'zmax':3000,
    'nx':750, 'dx':8,    'ox':2000,'xmin':2000,'xmax':8000,
    'nt':1000,'dt':0.001,'ot':0,
    'ng':3600,'dg':0.1,  'og':0
    }
# ------------------------------------------------------------
Fetch(['marmvel.hh'],'marm')

Flow('mvel','marmvel.hh','dd form=native | smooth rect1=51 rect2=51')
Plot('mvel',
     '''
     grey labelrot=n title=" " axes=n allpos=y bias=1500
     min2=%(xmin)g max2=%(xmax)g min1=%(zmin)g max1=%(zmax)g
     label1=z label2=x
     ''' % mpar)

Flow('mwft','mvel',
     '''
     hwt2d verb=n xsou=5000 zsou=2300 
     nt=%(nt)d ot=%(ot)g dt=%(dt)g
     ng=%(ng)d og=%(og)g dg=%(dg)g
     ''' % mpar)
Plot('mwft',
     '''
     window j1=50 |
     transp |\
     graph labelrot=n yreverse=y title=" " wantaxis=n
     min1=%(xmin)g max1=%(xmax)g min2=%(zmin)g max2=%(zmax)g
     ''' % mpar)

# ------------------------------------------------------------
Result('marm','mvel mwft','Overlay')
# ------------------------------------------------------------

Flow('mzs',None,'spike nsp=1 mag=0 n1=3000 d1=1 o1=0 | math output="0200+x1+x1/2*sin(x1/500)"' % mpar)
Flow('mxs',None,'spike nsp=1 mag=0 n1=3000 d1=1 o1=0 | math output="3000+1.5*x1"' % mpar)
Flow('mrs',None,'spike nsp=1 mag=0 n1=3000 d1=1 o1=0 | math output="1"' % mpar)
Flow('msou','mxs mzs',    'cat axis=2 space=n ${SOURCES[1]} | transp | dd type=complex | window')

Plot('msou','msou',
     '''
     graph labelrot=n yreverse=y symbol=. wantaxis=n title=" " plotcol=7 
     min1=%(xmin)g max1=%(xmax)g min2=%(zmin)g max2=%(zmax)g
     ''' % mpar)
Result('msou','mvel msou','Overlay')

Flow('mexp','mvel msou',
     '''
     hwtex verb=n sou=${SOURCES[1]}
     nt=%(nt)d ot=%(ot)g dt=%(dt)g
     ''' % mpar)
Plot('mexp',
     '''
     window j1=50 | transp |\
     graph labelrot=n yreverse=y title=" " wantaxis=n 
     min1=%(xmin)g max1=%(xmax)g min2=%(zmin)g max2=%(zmax)g
     ''' % mpar)

# ------------------------------------------------------------
Result('mexp','mvel msou mexp','Overlay')
# ------------------------------------------------------------

End()
