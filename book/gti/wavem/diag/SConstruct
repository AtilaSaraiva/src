from rsfproj import *

plot = "grey label1='Time (s)' label2='Lateral (km)' "

Flow('diag',None,
     '''
     spike n1=129 n2=131
     d1=0.004 d2=0.004
     nsp=6 
     k1=10,30,50,70,90,110 
     k2=10,30,50,70,90,110
     ''')

Plot('diag','diag',plot + "pclip=100 title=Model")

Flow('diag-fft','diag','cosft sign2=1')
Flow('diagz','diag','put d1=0.003')

Flow('diag-presto','diag-fft',
     'prestolt nh=131 dh=0.008 vel=1.5 inv=1')
Flow('diag-pre','diag-presto',
     'transp plane=23 | cosft sign2=-1 sign3=-1')

Plot('diag-presto',
     '''
     prestolt vel=1.5 |
     cosft sign2=-1 |
     %s pclip=99.8 title="Prestack Stolt" 
     ''' % plot)
Result('diag-presto','diag diag-presto','SideBySideAniso')

#Plot('diag-sstep','diagz',
#     '''sstep1 eps=0.01 nt=129 dt=0.004 vel=1.5 inv=1 |
#     %s pclip=99.8 title=Gazdag1''' % plot)
#Result('diag-sstep',['diag','diag-sstep'],'SideBySideAniso')

Flow('slow','diagz','transp | spray axis=2 n=1 | math output=%g' % (1/1.5))

Plot('diag-sstep2','diagz slow',
     '''
     transp | spray axis=2 n=1 |
     sstep2 eps=0.01 slowness=${SOURCES[1]} inv=y verb=y
     nw=66 dw=1.92308 | window | transp | fft1 inv=y |
     %s pclip=99.8 title=Split-step
     ''' % plot)
Result('diag-sstep2',['diag','diag-sstep2'],'SideBySideAniso')

Flow('diag-predsr','diag-fft',
     'dsr nh=65 dh=0.008 vel=1.5 inv=1 nt=129 dt=0.004')
Flow('diag-pre2','diag-predsr',
     'transp plane=23 | cosft sign2=-1 sign3=-1')

Plot('diag-dsr','diag-predsr',
     '''
     dsr vel=1.5 nz=129 dz=0.004 | window | cosft sign2=-1 |
     %s pclip=100 title="DSR"''' % plot)
Result('diag-dsr',['diag','diag-dsr'],'SideBySideAniso')

End()
