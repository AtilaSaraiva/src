from rsfproj import *
import math, string

mod = {
    'pp': [],
    'ps': []
    }
for ang in (0,15,30,45):
    ref = 'ref%d' % ang
    dip = 'dip%d' % ang
    Flow(dip,None,'spike n1=1000 d1=4 o1=0 mag=%g' % math.tan(ang*math.pi/180))
    Flow(ref,dip,'math output="300+input*x1" ')    
    for case in ('pp','ps'):
        kir = '%skir%d' % (case,ang)
        mod[case].append(kir)
        Flow(kir,[ref,dip],
             '''
             kirmod vel=2000 vel2=%d dip=${SOURCES[1]}
             nt=1500 dt=0.002 freq=20
             nh=128 dh=20 h0=-1280
             ns=1 ds=20 s0=1500 | tpow tpow=1
             ''' % ((2000,1000)[case=='ps']))

for case in ('pp','ps'):
    Flow(case,mod[case],'add ${SOURCES[1:%d]}' % len(mod[case]))
    Result(case,'grey title="%s" ' % string.upper(case))

End()
