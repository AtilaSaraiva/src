from rsfproj import *

Fetch('milo.rsf','ninec')

Flow('milo0','milo',
     '''
     dd form=native | put d1=0.001 |
     window n3=1 f3=6 f1=20 |
     pad beg1=20 |
     costaper nw1=80 nw2=80 |
     bandpass flo=20
     ''')
Result('milo','milo0','grey title="Milo\'s Near-Offset Gather" ')

Flow('dip','milo0','dip rect1=50 rect2=50')
Flow('pwd','milo0 dip',
     '''
     pwd dip=${SOURCES[1]} |
     bandpass fhi=250 |
     transp | bandpass fhi=0.03 | transp
     ''')

Result('midif','pwd','grey title="Isolated Diffractions" ')

Flow('vkx','milo0','pad n2=1000 | cosft sign2=1 verb=y | spray axis=2 n=1 o=0 d=5')

velcon = '''
fourvc pad=1024 pad2=2048 nv=200 dv=20 v0=0.00001 |
cosft sign3=-1 | window n3=869
'''

Flow('vlf','vkx',velcon)

Flow('pkx','pwd','pad n2=1000 | cosft sign2=1 verb=y | spray axis=2 n=1 o=0 d=5')

Flow('plf','pkx',velcon)

Flow('poc','plf','window j3=5 | focus rect1=40 rect3=10 | math output=1/input')
Flow('pic','poc','cut max1=0.1 | pick rect1=10 rect2=10')
Flow('pic2','pic','window | transp | spline n1=869 d1=5 o1=0 | transp')
Flow('plc','plf pic2','slice pick=${SOURCES[1]} | window')

Result('miplc','plc','grey title="Focused Diffractions" ')

Flow('slc','vlf pic2','slice pick=${SOURCES[1]} | window')

Result('mimig','slc','grey title=Migration')

End()
