from rsf.proj import *
from math import pi

Flow('signal',None,
     '''
     math n1=10001 o1=0 d1=0.001 label1=Time unit1=s 
     output="50*sin(%g*x1+%g)+100*sin(%g*x1+%g)" 
     ''' % (20*pi,pi/5,80*pi,pi/9))
Plot('signal','window max1=0.5 | graph label2=Amplitude wanttitle=n min1=-0.01 max1=0.51 min2=-170 max2=170 plotcol=4')

Flow('spectrum','signal','spectra')
Plot('spectrum','window max1=50 | graph plotcol=5 label2=Amplitude wanttitle=n plotcol=1')

Result('signal','signal spectrum','OverUnderAniso')

Flow('subsample','signal','window j1=60')

Plot('subsample','rtoc | math output="x1+I*input" | graph symbol=o min1=-0.01 max1=0.51 min2=-170 max2=170 plotcol=1 symbolsz=10 wanttitle=n wantaxis=n')

Flow('interp','subsample',
     'fft1 | pad n1=1025 | put fft_o1=0 fft_n1=2001 | fft1 inv=y | scale dscale=60')

Plot('interp','window max1=0.5 | graph label2=Amplitude wanttitle=n min1=-0.01 max1=0.51 min2=-170 max2=170 plotcol=5')

Plot('signal2','signal interp subsample','Overlay')

Flow('spectrum2','interp','spectra')
Plot('spectrum2','window max1=50 | graph plotcol=5 label2=Amplitude wanttitle=n plotcol=1')

Result('signal2','signal2 spectrum2','OverUnderAniso')


End()
